/******** PART a) *********/
CREATE TABLE employee(
    employee_name VARCHAR2(120) NOT NULL,
    birthdate DATE NOT NULL,
    salary NUMERIC(9,2) NOT NULL,
    PRIMARY KEY(employee_name),
    CHECK (salary >= 0)
    );
    
CREATE TABLE works_in_project(
    project_ID INT NOT NULL,
    employee_name VARCHAR2(120) NOT NULL,
    num_hr INT,
    PRIMARY KEY(project_id, employee_name),
    FOREIGN KEY(employee_name) REFERENCES employee,
    CHECK (num_hr >= 0)
    );
    
CREATE TABLE is_supervised_by(
    name VARCHAR2(120),
    supervisor_name VARCHAR2(120),
    PRIMARY KEY(name),
    FOREIGN KEY(supervisor_name) REFERENCES employee,
    FOREIGN KEY(name) REFERENCES employee
    );
    
INSERT INTO EMPLOYEE (EMPLOYEE_NAME,BIRTHDATE,SALARY)
VALUES ('Valjean', TO_DATE('09/23/1956', 'MM/DD/YYYY'), 56000.00);

INSERT INTO EMPLOYEE (EMPLOYEE_NAME,BIRTHDATE,SALARY)
VALUES ('Cosette', TO_DATE('01/24/1997', 'MM/DD/YYYY'), 25000.00);

INSERT INTO EMPLOYEE (EMPLOYEE_NAME,BIRTHDATE,SALARY)
VALUES ('Fantine', TO_DATE('06/14/1985', 'MM/DD/YYYY'), 49000.00);

INSERT INTO EMPLOYEE (EMPLOYEE_NAME,BIRTHDATE,SALARY)
VALUES ('Gabroche', TO_DATE('04/09/2001', 'MM/DD/YYYY'), 10000.00);

INSERT INTO IS_SUPERVISED_BY (NAME, SUPERVISOR_NAME)
VALUES ('Cosette', 'Valjean');

INSERT INTO IS_SUPERVISED_BY (NAME, SUPERVISOR_NAME)
VALUES ('Fantine', 'Valjean');

INSERT INTO IS_SUPERVISED_BY (NAME, SUPERVISOR_NAME)
VALUES ('Gabroche', 'Cosette');

INSERT INTO WORKS_IN_PROJECT (PROJECT_ID, EMPLOYEE_NAME, NUM_HR)
VALUES ('12', 'Valjean', '80');

INSERT INTO WORKS_IN_PROJECT (PROJECT_ID, EMPLOYEE_NAME, NUM_HR)
VALUES ('26', 'Valjean', '23');

INSERT INTO WORKS_IN_PROJECT (PROJECT_ID, EMPLOYEE_NAME, NUM_HR)
VALUES ('12', 'Fantine', '12');

INSERT INTO WORKS_IN_PROJECT (PROJECT_ID, EMPLOYEE_NAME, NUM_HR)
VALUES ('17', 'Cosette', '6');

/******** PART b) *********/
SELECT employee_name as "Employee Name" FROM EMPLOYEE;

/******** PART c) *********/
SELECT DISTINCT employee_name FROM WORKS_IN_PROJECT
WHERE (WORKS_IN_PROJECT.NUM_HR) > 20;
/******** PART d) *********/
SELECT DISTINCT employee_name,salary FROM EMPLOYEE;

/******** PART e) *********/
SELECT * FROM EMPLOYEE,WORKS_IN_PROJECT;

/******** PART f) *********/
SELECT EMPLOYEE.EMPLOYEE_NAME, EMPLOYEE.SALARY
FROM EMPLOYEE
INNER JOIN IS_SUPERVISED_BY
ON EMPLOYEE.EMPLOYEE_NAME = IS_SUPERVISED_BY.NAME
WHERE IS_SUPERVISED_BY.SUPERVISOR_NAME IN ('Cosette','Fantine');

/******** BONUS *********/
SELECT IS_SUPERVISED_BY.SUPERVISOR_NAME, AVG(EMPLOYEE.SALARY)
FROM EMPLOYEE
INNER JOIN IS_SUPERVISED_BY
ON EMPLOYEE.EMPLOYEE_NAME = IS_SUPERVISED_BY.SUPERVISOR_NAME
GROUP BY IS_SUPERVISED_BY.SUPERVISOR_NAME, EMPLOYEE.SALARY;